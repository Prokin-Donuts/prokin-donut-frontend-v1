<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shortcut icon" href="assets/images/logo/favicon_logo.png" type="image/png" />
    <title>Prokin Donuts</title>

    <!-- ========== All CSS files linkup ========= -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
    <link rel="stylesheet" href="assets/css/lineicons.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="assets/css/materialdesignicons.min.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="assets/css/fullcalendar.css" />
    <link rel="stylesheet" href="assets/css/main.css" />
    <!-- datatable을 위해 필요함 -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">
    
  </head>

  <body>
    <!-- ======== Preloader =========== -->
    <div id="preloader">
      <div class="spinner"></div>
    </div>
    <!-- ======== Preloader =========== -->

   <!-- ======== sidebar-nav start =========== -->
   <aside class="sidebar-nav-wrapper">
    <div class="navbar-logo">
      <a href="qh-dashboard.html">
        <img src="assets/images/logo/menu_logo.png" alt="logo" />
      </a>
    </div>
    <nav class="sidebar-nav">
      <ul>
        <li class="nav-item">
        </li>
        <li class="nav-item nav-item-has-children">
          <a
            href="#0"
            class="collapsed"
            data-bs-toggle="collapse"
            data-bs-target="#ddmenu_2"
            aria-controls="ddmenu_2"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="icon">
              <i width="20" height="20" viewBox="0 0 20 20" fill="none" class="lni lni-users"></i>
            </span>
            <span class="text">회원관리</span>
          </a>
          <ul id="ddmenu_2" class="collapse dropdown-nav">
            <li>
              <a href="qh-member-list.html" class="hover-text-grow"> 회원목록 </a>
            </li>
            <li>
              <a href="qh-member-request.html" class="hover-text-grow" > 회원 가입 요청 목록 </a>
            </li>
          </ul>
        </li>
        <li class="nav-item">
          <a href="qh-warehouse.html">
            <span class="icon">
              <i width="20" height="20" viewBox="0 0 20 20" fill="none" class="lni lni-chef-hat"></i>
            </span>
            <span class="text">창고관리</span>
          </a>
        </li>
        <li class="nav-item">
          <a href="qh-franchise.html">
            <span class="icon">
              <i width="20" height="20" viewBox="0 0 20 20" fill="none" class="lni lni-apartment"></i>
            </span>
            <span class="text">가맹점관리</span>
          </a>
        </li>
        <li class="nav-item">
          <a href="qh-inventory.html">
            <span class="icon">
              <i width="20" height="20" viewBox="0 0 20 20" fill="none" class="lni lni-package"></i>
            </span>
            <span class="text">재고관리</span>
          </a>
        </li>
        <li class="nav-item">
          <a href="qh-product.html">
            <span class="icon">
              <i width="20" height="20" viewBox="0 0 20 20" fill="none" class="lni lni-apartment"></i>
            </span>
            <span class="text">제품관리</span>
          </a>
        </li>
        <li class="nav-item nav-item-has-children">
          <a
            href="#0"
            class="collapsed"
            data-bs-toggle="collapse"
            data-bs-target="#ddmenu_55"
            aria-controls="ddmenu_55"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="icon">
              <i width="20" height="20" viewBox="0 0 20 20" fill="none" class="lni lni-cart"></i>
            </span>
            <span class="text">입고관리</span>
          </a>
          <ul id="ddmenu_55" class="collapse dropdown-nav">
            <li>
              <a href="qh-inbound_request.html" class="hover-text-grow"> 입고 요청 목록 </a>
            </li>
            <li>
              <a href="qh-inbound_status.html" class="hover-text-grow"> 입고현황 </a>
            </li>
          </ul>
        </li>
        <li class="nav-item">
          <a href="qh-outbound.html">
            <span style="color:  #FF9D32; margin-right: 13px;">
              <i width="20" height="20" viewBox="0 0 20 20" fill="none" class="lni lni-home"></i>
            </span>
            <span  style="color:  #1c1c1c;">출고관리</span>
          </a>
        </li>
      </ul>
    </nav>

  </aside>
  <div class="overlay"></div>
    <!-- ======== sidebar-nav end =========== -->

    <!-- ======== main-wrapper start =========== -->
    <main class="main-wrapper">
      <!-- ========== header start ========== -->
      <header class="header">
        <div class="container-fluid">
          <div class="row">
            <div class="col-lg-5 col-md-5 col-6">
              <div class="header-left d-flex align-items-center">
                <div class="menu-toggle-btn mr-15">
                  <button id="menu-toggle" class="main-btn primary-btn btn-hover">
                    <i class="lni lni-chevron-left me-2"></i> Menu
                  </button>
                </div>
              </div>
            </div>
            <div class="col-lg-7 col-md-7 col-6">
              <div class="header-right">

               <!-- profile start -->
               <div class="profile-box ml-15">
                <button class="dropdown-toggle bg-transparent border-0" type="button" id="profile" data-bs-toggle="dropdown" aria-expanded="false">
                  <div class="profile-info">
                    <div class="info">
                      <div class="image">
                        <img src="assets/images/profile/user_profile.png" alt="" />
                      </div>
                      <div>
                        <h6 class="fw-500">김관리자</h6>
                        <p>QH Admin</p>
                      </div>
                    </div>
                  </div>
                </button>
                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="profile">
                  <li>
                    <div class="flex items-center !p-1">
                      <div class="content-a">
                        <h6>김관리자</h6>
                        <p>Email@gmail.com</p>
                      </div>
                    </div>
                  </li>
                  <li class="divider"></li>
                  <li> 
                    <a  href="#mypageModal" data-bs-toggle="modal" id="btnmypageMenu">      
                      <i class="lni lni-user"></i> my page
                    </a>
                  </li>
                  <li>
                    <a href="index.html"> <i class="lni lni-exit"></i> Sign Out </a>
                  </li>
                </ul>
              </div>
              <!-- profile end -->
              </div>
                          </div>
                        </div>
                      </div>
                    </header>
                    <!-- ========== header end ========== -->
              <!-- Modal HTML Start -->
              <!-- 마이페이지 모달 -->
              <div class="modal fade" id="mypageModal" tabindex="-1" aria-labelledby="mypageModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h3 class="modal-title" id="mypageModalLabel">내 회원 정보</h3>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                      <form id="modifyForm">
                        <input type="hidden" id="mypageId">
                        
                        <div class="mb-3">
                          <label class="form-label">아이디</label>
                          <input type="id" class="form-control" id="id">
                        </div>
                        <div class="mb-3">
                          <label class="form-label">비밀번호</label>
                          <input type="text" class="form-control" id="password">
                        </div>
                        
                        <div class="mb-3">
                          <label class="form-label">이름</label>
                          <input type="text" class="form-control" id="name">
                        </div>
                        
                        <div class="mb-3">
                          <label class="form-label">이메일</label>
                          <input type="email" class="form-control" id="email">
                        </div>
                        
                        <div class="mb-3">
                          <label class="form-label">전화번호</label>
                          <input type="text" class="form-control" id="PhoneNumber">
                        </div>
                        
                        <div class="mb-3">
                          <label class="form-label">주소</label>
                          <input type="text" class="form-control" id="address">
                        </div>
                      </div>
                    </form>
                    <div class="text-center w-100 mt-1 mb-3">
                      <button type="submit"class="main-btn primary-btn btn-hover text-center" >수정</button>
                    </div>
                    <div class="text-center mb-3">
                    <a href=#0 id = "bntMypageSecession">탈퇴</a> 
                    </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Modal HTML End -->

      <!-- ========== section start ========== -->
      <section class="section">
        <div class="container-fluid">
          <!-- ========== title-wrapper start ========== -->
          <div class="title-wrapper pt-30">
            <div class="row align-items-center">
              <div class="col-md-6">
                <div class="title">
                  <h2>출고 관리</h2>
                </div>
              </div>
            </div>
          </div>
         
          <!-- ========== title-wrapper end ========== -->
          <div class="row">
            <!-- 왼쪽 테이블 -->
            <div class="col-lg-6">
              <div class="card-style mb-30">
                <h6 class="mb-20">발주 요청 목록</h6>
                <div id="myCustomFilters" style="display: none;">
                  <div class="d-flex align-items-center gap-2" style="margin-top: -30px;">
                    <div class="btu-group-1 d-flex gap-2">
                      <button class="main-btn warning-btn-outline btn-hover btn-sm btn-xs" id="btnApprove">승인</button>
                    </div>
                  </div>
                </div>
                <div class="table-wrapper table-responsive p-0">
                  <table id="datatable_1" class="table striped-table w-100 orderApprove-datatable">
                    <thead>
                      <tr>
                        <th><input type="checkbox" id="select-all"></th>
                        <th>발주코드</th>
                        <th>발주일</th>
                        <th>발주상태</th>
                        <th>지점명</th>
                      </tr>
                    </thead>
                    <tbody></tbody>
                  </table>
                </div>
              </div>
            </div>
          
            <!-- 오른쪽 테이블 -->
            <div class="col-lg-6">
            <div class="card-style mb-30">
              <h6 class="mb-10">출고 진행 목록</h6>
              <p class="text-sm mb-20"></p>
                <div id="myCustomFilters2" style="display: none;">
                  <div class="d-flex align-items-center gap-2" style="margin-top: -30px;">
                   </div>
                </div>
              <div class="table-wrapper p-0">
                <!-- Start table -->
                <table id="datatable_2" class="table striped-table w-100 member-datatable" style="width:100%">
                  <thead>
                    <tr>
                      <th>출고코드</th>
                      <th>발주일</th>
                      <th>지점명</th>
                      <th>출고상태</th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
          <!-- Modal HTML Start -->
         <!-- 승인 모달 -->
          <div class="modal fade" id="approveModal" tabindex="-1" aria-labelledby="approveModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
              <div class="modal-content">
                <div class="modal-header">
                  <h3 class="modal-title" id="approveModalLabel">발주 승인</h3>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                  <h5>선택한 발주 요청을 승인하겠습니까?</h5><br>
                  <ul id="approveList" class="list-group mb-3">
                    <!-- 선택된 회원 목록 삽입 -->
                  </ul>
                  <div class="d-flex justify-content-end gap-2">
                    <button type="button" class="main-btn primary-btn btn-hover text-center" id="confirmApprove">승인</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- Modal HTML End -->

        </div>
      </section>
      <!-- ========== section end ========== -->

      <!-- ========== footer start =========== -->
      <footer class="footer">
        <div class="container-fluid">
          <div class="row">
            <div class="col-md-12">
              <div class="terms d-flex justify-content-center justify-content-md-end">
                <a href="https://small-ragdoll-a57.notion.site/Prokin-Donuts-1b83a719d3508047953eeda89caeec14" class="text-sm">Brand Story</a>
                <a href="https://github.com/Prokin-Donuts/Prokin-Donuts" class="text-sm ml-15">Dev Hub</a>
              </div>
            </div>
            <!-- end col-->
          </div>
          <!-- end row -->
        </div>
        <!-- end container -->
      </footer>
      <!-- ========== footer end =========== -->
    </main>
    <!-- ======== main-wrapper end =========== -->

    <!-- ========= All Javascript files linkup ======== -->
    <script src="assets/js/Chart.min.js"></script>
    <script src="assets/js/dynamic-pie-chart.js"></script>
    <script src="assets/js/moment.min.js"></script>
    <script src="assets/js/fullcalendar.js"></script>
    <script src="assets/js/jvectormap.min.js"></script>
    <script src="assets/js/world-merc.js"></script>
    <script src="assets/js/polyfill.js"></script>
    <script src="assets/js/main.js"></script>
    <!-- datatable을 위해 필요함 -->
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="assets/js/bootstrap.bundle.min.js"></script>

    <script>
    $(document).ready(function() {
      // 1. DataTable 초기화
      // 첫 번째 DataTable (예시: 발주 목록)
      const table1 = $('#datatable_1').DataTable({
        autoWidth: false,
        columnDefs: [
          { width: '95px', targets: -1 },
          { targets: [1, 2, 3, 4], className: 'text-center' }
        ],
        order: [[1, 'asc']],
        // ajax, columns, paging 등 실제 옵션을 채워주세요.
        ajax: function (data, callback, settings) {
          // 더미 데이터 예시
          const dummyOrders = [
            { orderCode: "ORD1", orderDate: "2025-03-22", orderStatus: "승인대기", fmName: "수원영통점" },
            { orderCode: "ORD2", orderDate: "2025-03-24", orderStatus: "승인대기", fmName: "수원영통점" },
            { orderCode: "ORD3", orderDate: "2025-03-26", orderStatus: "승인대기", fmName: "대전둔산점" },
            { orderCode: "ORD4", orderDate: "2025-03-28", orderStatus: "승인대기", fmName: "대전둔산점" },
            { orderCode: "ORD5", orderDate: "2025-03-30", orderStatus: "승인대기", fmName: "대전둔산점" }
          ];
          Promise.resolve().then(() => callback({ data: dummyOrders }));
        },
        columns: [
          {
            data: null,
            orderable: false,
            searchable: false,
            render: () => '<input type="checkbox" class="row-checkbox">'
          },
          { data: 'orderCode', title: '발주코드' },
          { data: 'orderDate', title: '발주일' },
          { data: 'orderStatus', title: '발주상태' },
          { data: 'fmName', title: '지점명' }
        ],
        paging: true,
        pageLength: 10,
        lengthMenu: [[5, 10, 20, -1], ['5개', '10개', '20개', '전체']],
        searching: true,
        ordering: true,
        info: true,
        lengthChange: true,
        dom: '<"top"l<"myFilterArea_1">fr>t<"bottom"ip>',
        language: {
          lengthMenu: '_MENU_',
          search: "검색 ",
          info: "Showing _START_ to _END_ of _TOTAL_ entries",
          infoEmpty: "no data",
          emptyTable: "empty table",
          paginate: {
            previous: "< prev",
            next: "next >"
          }
        },
        initComplete: function () {
          // 원하는 초기 스타일 설정 등
          fixLengthDropdownStyle('datatable_1');
          // 2. 요소 복제
          const $clone = $('#myCustomFilters').clone(true).css('display','block');
          $clone.find('#btnApprove').attr('id', 'btnApprove_clone');
          $(this.api().table().container())
            .find('div.myFilterArea_1')
            .append($clone);
        },
        drawCallback: function () {
          $('#datatable_1 thead th').eq(0).removeClass('sorting sorting_asc sorting_desc');
          $('#select-all').prop('checked', false);
        }
      });

      // 두 번째 DataTable (예시: 출고 진행 목록)
      const table2 = $('#datatable_2').DataTable({
        autoWidth: false,
        columnDefs: [
          { targets: [0, 1, 2, 3], className: 'text-center' }
        ],
        order: [[0, 'asc']],
        ajax: function (data, callback, settings) {
          const dummyOutbound = [
            { outboundCode: "OUT1", outboundDate: "2025-03-22", fmName: "수원영통점", outboundStatus: "출고대기" },
            { outboundCode: "OUT2", outboundDate: "2025-03-22", fmName: "대전둔산점", outboundStatus: "출고대기" },
            { outboundCode: "OUT3", outboundDate: "2025-03-22", fmName: "대전둔산점", outboundStatus: "출고대기" },
            { outboundCode: "OUT4", outboundDate: "2025-03-22", fmName: "수원영통점", outboundStatus: "출고대기" },
            { outboundCode: "OUT5", outboundDate: "2025-03-22", fmName: "대전둔산점", outboundStatus: "출고대기" }
          ];
          Promise.resolve().then(() => callback({ data: dummyOutbound }));
        },
        columns: [
          { data: 'outboundCode', title: '출고코드' },
          { data: 'outboundDate', title: '발주일' },
          { data: 'fmName', title: '지점명' },
          { data: 'outboundStatus', title: '출고상태' }
        ],
        paging: true,
        pageLength: 10,
        lengthMenu: [[5, 10, 20, -1], ['5개', '10개', '20개', '전체']],
        searching: true,
        ordering: true,
        info: true,
        lengthChange: true,
        dom: '<"top"l<"myFilterArea_2">fr>t<"bottom"ip>',
        language: {
          lengthMenu: '_MENU_',
          search: "검색 ",
          info: "Showing _START_ to _END_ of _TOTAL_ entries",
          infoEmpty: "no data",
          emptyTable: "empty table",
          paginate: {
            previous: "< prev",
            next: "next >"
          }
        },
        initComplete: function () {
          fixLengthDropdownStyle('datatable_2');
        },
        drawCallback: function () {
          // DataTables 페이징 버튼 스타일 커스터마이징 등
        }
      });

      // 3. DataTable length dropdown 및 검색 input 커스텀 스타일 함수
      function fixLengthDropdownStyle(tableId) {
        // 해당 테이블의 wrapper 선택
        const $table = $('#' + tableId);
        const $wrapper = $table.closest('.dataTables_wrapper');
        const $length = $wrapper.find('.dataTables_length');
        const $filter = $wrapper.find('.dataTables_filter');

        // 이미 스타일이 적용되어 있으면 리턴
        if ($length.find('.select-style-1').length > 0) return;

        const $select = $length.find('select');
        const selectedValue = $select.val();

        // label 안에 있는 텍스트 노드 제거 (예: "Show")
        $length.find('label').contents().filter(function () {
          return this.nodeType === 3;
        }).remove();

        // 새 wrapper 구성
        const $newWrapper = $(`
          <div class="select-style-1">
            <div class="select-position"></div>
          </div>
        `);
        const $newInput = $('<div class="input-style-1"></div>');

        // select 엘리먼트를 새 wrapper로 이동
        $select.detach();
        $newWrapper.find('.select-position').append($select);
        $length.empty().append($newWrapper);

        // filter 영역의 input 변경: placeholder를 Search...로 지정
        const $input = $filter.find('input');
        $input.detach();
        $input.attr('placeholder', 'Search...');
        $newInput.append($input);
        $filter.empty().append($newInput);

        // 기존 선택값 복원
        $select.val(selectedValue);
      }

      // 4. 테이블 그리는 함수
      // 첫 번째 테이블 draw 이벤트 (table1이 첫 번째 DataTable 객체)
      table1.on('draw', function () {
        $('#datatable_1_wrapper .dataTables_paginate .paginate_button')
          .removeClass()
          .addClass('main-btn deactive-btn-outline square-btn btn-hover mt-1 pt-2 pb-2 pl-15 pr-15');
      });

      // 두 번째 테이블 draw 이벤트 (table2이 두 번째 DataTable 객체)
      table2.on('draw', function () {
        $('#datatable_2_wrapper .dataTables_paginate .paginate_button')
          .removeClass()
          .addClass('main-btn deactive-btn-outline square-btn btn-hover mt-1 pt-2 pb-2 pl-15 pr-15');
      });

      // 5. "Select All" 체크박스 기능 (첫 번째 테이블만 예시)
      $('#select-all').on('click', function () {
        const rows = table1.rows({ page: 'current' }).nodes();
        $('input.row-checkbox', rows).prop('checked', this.checked);
      });

      // 각 행의 개별 체크박스 변경 시 "Select All" 체크 해제
      $('#datatable_1 tbody').on('change', 'input.row-checkbox', function () {
        if (!this.checked) {
          const el = $('#select-all').get(0);
          if (el && el.checked) el.checked = false;
        }
      });

      // 6. 승인 버튼 클릭 이벤트 -> 이벤트 위임 방식 사용필
      $(document).on('click', '#btnApprove_clone', function () {
        const selectedRows = table1.rows({ page: 'current' }).nodes();
        const selectedData = [];
        $(selectedRows).each(function () {
          if ($(this).find('.row-checkbox').prop('checked')) {
            const data = table1.row(this).data();
            selectedData.push(data);
          }
        });

        if (selectedData.length === 0) {
          alert('승인할 요청을 선택하세요.');
          return;
        }

        const $list = $('#approveList');
        $list.empty();
        selectedData.forEach((item) => {
          const $li = $(`
            <li class="list-group-item d-flex justify-content-between align-items-center">
              <span>${item.fmName} (${item.orderDate})</span>
              <span class="badge bg-secondary">${item.orderStatus}</span>
            </li>
          `);
          $list.append($li);
        });

        $('#approveModal').modal('show');
      });

      // 7. 기타 이벤트: mypage 버튼 클릭, 탈퇴 버튼 등
      $('#btnmypageEmail, #btnmypageMenu').on('click', function () {
        const userInfo = {
          id: 'kim_admin',
          password: 'dummyPassword',
          name: '김관리자',
          email: 'email@example.com',
          phone: '010-1234-5678',
          address: '서울시 강남구'
        };
        $('#id').val(userInfo.id);
        $('#password').val(userInfo.password);
        $('#name').val(userInfo.name);
        $('#email').val(userInfo.email);
        $('#PhoneNumber').val(userInfo.phone);
        $('#address').val(userInfo.address);
        $('#mypageModal').modal('show');
      });

      $('#bntMypageSecession').on('click', function (e) {
        const result = confirm('⚠️ 계정을 삭제하시겠습니까?\n삭제된 계정은 복구되지 않습니다.');
        if (result) {
          console.log('삭제 진행!');
        } else {
          console.log('삭제 취소됨!');
        }
        $('#mypageModal').modal('show');
      });
    });

    
// mypage 버튼 클릭 시
$('#btnmypageEmail, #btnmypageMenu').on('click', function () {
    const userInfo = {
        id: 'kim_admin',
        password: 'dummyPassword',
        name: '김관리자',
        email: 'email@example.com',
        phone: '010-1234-5678',
        address: '서울시 강남구'
    };

    $('#id').val(userInfo.id);
    $('#password').val(userInfo.password);
    $('#name').val(userInfo.name);
    $('#email').val(userInfo.email);
    $('#PhoneNumber').val(userInfo.phone);
    $('#address').val(userInfo.address);

    $('#mypageModal').modal('show');
});


//mypage 탈퇴 
$('#bntMypageSecession').on('click', function (e) {

  const result = confirm('⚠️ 계정을 삭제하시겠습니까?\n삭제된 계정은 복구되지 않습니다.');

if (result) {
  // 확인 눌렀을 때 실행
  console.log('삭제 진행!');
} else {
  // 취소 눌렀을 때 실행
  console.log('삭제 취소됨!');
}
  
  $('#mypageModal').modal('show');
});
    </script>
    
  </body>
</html>