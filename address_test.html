<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shortcut icon" href="assets/images/logo/favicon_logo.png" type="image/png" />
    <title>Prokin Donuts</title>

    <!-- ========== All CSS files linkup ========= -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
    <link rel="stylesheet" href="assets/css/lineicons.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="assets/css/materialdesignicons.min.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="assets/css/fullcalendar.css" />
    <link rel="stylesheet" href="assets/css/fullcalendar.css" />
    <link rel="stylesheet" href="assets/css/main.css" />
    <!-- datatable을 위해 필요함 -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">

    
  </head>
  <body>
    <!-- 창고 등록 모달 -->
    <div
      class="modal fade" id="warehouseAddModal"
      tabindex="-1" aria-labelledby="warehouseAddModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">

          <!-- 모달 헤더 -->
          <div class="modal-header">
            <h3 class="modal-title" id="warehouseAddModalLabel">창고 등록</h3>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close">
            </button>
          </div>

          <!-- 모달 바디 -->
          <div class="modal-body">

              <!-- 필수 입력 항목 안내 -->
              <p class="text-danger fw-normal mb-3">(*)는 필수 입력 항목입니다.</p>

              <!-- 등록 폼 -->
              <form id="warehouseRegisterForm" action="#" method="post">

              <!-- 창고명 (중복확인 버튼 포함) -->
              <div class="mb-3">
                <label for="warehouseName" class="form-label">창고명 (*)</label>
                <div class="d-flex gap-2">
                  <input
                    type="text"
                    placeholder="창고명을 입력하세요"
                    class="form-control"
                    id="warehouseName"
                    name="warehouseName"
                  />
                  <button
                    type="button"
                    class="main-btn primary-btn btn-hover btn-smaller"
                    id="checkDuplicate"
                  >
                    중복 확인
                  </button>
                </div>
              </div>

              <!-- 소재지 (다음 우편번호 API 적용) -->
              <div class="mb-3">
                <label class="form-label">소재지 (*)</label>
                <div class="d-flex gap-2">
                  <input
                    type="text"
                    class="form-control"
                    id="zonecode_disp"
                    placeholder="우편번호"
                    disabled
                  />
                  <button
                    type="button"
                    class="main-btn primary-btn btn-hover btn-smaller"
                    id="search-btn"
                  >
                    우편번호
                  </button>
                </div>
                <input
                  type="text"
                  class="form-control mt-1"
                  id="roadAddress_disp"
                  placeholder="도로명 주소"
                  disabled
                />
                <input
                  type="text"
                  class="form-control mt-1"
                  id="detailAddress_disp"
                  placeholder="상세주소를 입력해주세요."
                />

                <!-- ---------------------- -->
                <!-- 숨긴 필드: 서버 전송용 -->
                <!-- ---------------------- -->
                <input type="hidden" name="zonecode" id="zonecode_hidden" />
                <input type="hidden" name="roadAddress" id="roadAddress_hidden" />
                <input type="hidden" name="detailAddress" id="detailAddress_hidden" />

              </div>

              <!-- 수용한도 (레이블 제거, 인풋 그룹 안에 표시) -->
              <div class="mb-3">
                <label class="form-label">수용한도 (*)</label>
                <div class="input-group">
                  <input
                    type="text"
                    class="form-control"
                    id="capacity"
                    name="capacity"
                    placeholder="한도를 입력하세요"
                  />
                  <span class="input-group-text">m제곱</span>
                </div>
              </div>

              <!-- 담당자 (드롭다운) -->
              <div class="mb-3">
                <label for="manager" class="form-label">담당자</label>
                <select class="form-select" id="manager" name="manager">
                  <option value="">담당자 선택</option>
                  <!-- 더미데이터는 AJAX 시뮬레이션으로 채워집니다 -->
                </select>
              </div>

              <!-- 등록 버튼 -->
              <div class="text-center w-100 mt-1 mb-3">
                <button
                  type="submit"
                  class="main-btn primary-btn btn-hover text-center"
                  id="warehouseRegisterBtn"
                >
                  등록
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- 모달 끝 -->

    <!-- 삭제 모달 -->
    <div class="modal fade" id="memberDeleteModal" tabindex="-1" aria-labelledby="memberDeleteModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h3 class="modal-title" id="memberDeleteModalLabel">회원 삭제</h3>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <h5>선택한 회원을 정말 삭제하시겠습니까?</h5><br>
            <ul id="deleteMemberList" class="list-group mb-3">
              <!-- 선택된 회원 목록 삽입 -->
            </ul>
            <div class="d-flex justify-content-end gap-2">
              <button type="button" class="main-btn primary-btn btn-hover text-center" id="confirmDelete">삭제</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Modal HTML End -->

    <!-- 모달 여는 버튼 -->
    <div class="container mt-3">
      <button
        type="button"
        class="main-btn warning-btn-outline btn-hover btn-sm btn-xs"
        id="openWarehouseModal"
      >
        창고 등록 열기
      </button>
    </div>

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Bootstrap Bundle JS (includes Popper) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- 다음 우편번호 API -->
    <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    
    
    
    <script>
      $(document).ready(function () {
        // 모달 열기
        $("#openWarehouseModal").on("click", function () {
          $("#warehouseAddModal").modal("show");
        });

        // 창고명 중복 확인 (더미 예시)
        $("#checkDuplicate").on("click", function () {
          const warehouseName = $("#warehouseName").val().trim();
          if (!warehouseName) {
            alert("창고명을 입력하세요.");
            return;
          }
          // 여기서 실제 AJAX로 중복 여부 체크 가능
          // 예제에서는 항상 가능하다고 가정
          alert("사용 가능한 창고명입니다.");
        });

        // 담당자 드롭다운: AJAX 시뮬레이션 (더미 데이터)
        function loadManagers() {
          const dummyManagers = [
          { id: "WM1", name: "이근면" },
          { id: "WM2", name: "김세진" },
          { id: "WM3", name: "박수연" },
          { id: "WM4", name: "오민재" }
        ];

          const $select = $('#manager');
          $select.empty().append(`<option value="">담당자 선택</option>`); // 기본값 초기화

          dummyManagers.forEach(manager => {
            const label = `${manager.id} | ${manager.name}`;
            $select.append(`<option value="${manager.id}">${label}</option>`);
          });
        }

        // 모달 표시될 때마다 담당자 목록 로드(필요 시점에 맞춰 호출)
        $("#warehouseAddModal").on("show.bs.modal", function () {
          loadManagers();
        });

        // Daum 우편번호 찾기
        $("#search-btn").on("click", function () {
          new daum.Postcode({
            oncomplete: function (data) {
              // 팝업에서 검색결과 선택 시 실행
              $("#zonecode_disp").val(data.zonecode);
              $("#roadAddress_disp").val(data.roadAddress);

              // 서버 전송용 hidden 필드 업데이트
              $("#zonecode_hidden").val(data.zonecode);
              $("#roadAddress_hidden").val(data.roadAddress);
            },
          }).open();
        });

        // 상세 주소 변경 시 hidden 필드에 반영
        $("#detailAddress_disp").on("change", function () {
          $("#detailAddress_hidden").val($(this).val());
        });

        // 폼 제출
        $("#warehouseRegisterForm").on("submit", function (e) {
          e.preventDefault();
          // 추가 검증 및 실제 서버 전송 로직 가능
          alert("창고가 성공적으로 등록되었습니다.");
          $("#warehouseAddModal").modal("hide");
          // 폼 초기화
          $(this)[0].reset();
        });
      });
    </script>
  </body>
</html>